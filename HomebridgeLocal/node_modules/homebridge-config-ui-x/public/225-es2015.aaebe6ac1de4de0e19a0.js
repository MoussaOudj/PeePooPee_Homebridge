(self.webpackChunkui=self.webpackChunkui||[]).push([[225],{94225:function(t,e,s){"use strict";s.r(e),s.d(e,{LinuxModule:function(){return T}});var r=s(38583),i=s(95935),n=s(40294),a=s(63423),o=s(37716),c=s(79274),l=s(45417),u=s(92503),h=s(49344),p=s(48703);function g(t,e){1&t&&o._UZ(0,"app-spinner")}function m(t,e){1&t&&(o.TgZ(0,"p",6),o._uU(1,"Please wait, this page will automatically redirect when the Homebridge is back online."),o.qZA()),2&t&&o.Q6J("translate","platform.linux.restart.message_please_wait_while_server_restarts")}function _(t,e){if(1&t&&(o.TgZ(0,"p",7),o._uU(1),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Oqu(t.error)}}function f(t,e){1&t&&(o.TgZ(0,"div"),o.TgZ(1,"p",6),o._uU(2,"Server restart is taking a long time. You may need to bring up the server back up manually."),o.qZA(),o.qZA()),2&t&&(o.xp6(1),o.Q6J("translate","platform.linux.restart.message_server_taking_long_time_to_restart"))}function d(t,e){1&t&&(o.TgZ(0,"p",5),o._uU(1,"The server will power down shortly."),o.qZA()),2&t&&o.Q6J("translate","platform.linux.shutdown.message_server_will_power_down")}function x(t,e){if(1&t&&(o.TgZ(0,"p",6),o._uU(1),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Oqu(t.error)}}const v=[{path:"",redirectTo:"/",pathMatch:"full"},{path:"restart-server",component:(()=>{class t{constructor(t,e,s,r,i,n){this.$api=t,this.$ws=e,this.$settings=s,this.$toastr=r,this.translate=i,this.$router=n,this.io=this.$ws.connectToNamespace("status"),this.resp={},this.timeout=!1,this.error=!1}ngOnInit(){this.io.connected.subscribe(()=>{this.io.socket.emit("monitor-server-status"),this.$settings.getAppSettings().catch()}),this.$api.put("/platform-tools/linux/restart-host",{}).subscribe(t=>{this.resp=t,this.checkIfServerUp()},t=>{this.error=this.translate.instant("platform.linux.restart.toast_server_restart_error"),this.$toastr.error(`${this.error}: ${t.message}`,this.translate.instant("toast.title_error"))})}checkIfServerUp(){this.checkDelay=setTimeout(()=>{this.io.socket.on("homebridge-status",t=>{"up"!==t.status&&"pending"!==t.status||(this.$toastr.success(this.translate.instant("platform.linux.restart.toast_server_restarted"),this.translate.instant("toast.title_success")),this.$router.navigate(["/"]))})},3e4),this.checkTimeout=setTimeout(()=>{this.$toastr.warning(this.translate.instant("platform.linux.restart.toast_server_taking_long_time_to_come_online"),this.translate.instant("toast.title_warning"),{timeOut:1e4}),this.timeout=!0},12e4)}ngOnDestroy(){this.io.end(),clearTimeout(this.checkDelay),clearTimeout(this.checkTimeout)}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(c.s),o.Y36(l.r),o.Y36(u.g),o.Y36(h._W),o.Y36(i.sK),o.Y36(a.F0))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-restart-linux"]],decls:8,vars:5,consts:[[4,"ngIf"],[1,"row"],[1,"col-md-12","text-center"],[1,"primary-text",3,"translate"],["class","grey-text",3,"translate",4,"ngIf"],["class","grey-text",4,"ngIf"],[1,"grey-text",3,"translate"],[1,"grey-text"]],template:function(t,e){1&t&&(o.YNc(0,g,1,0,"app-spinner",0),o.TgZ(1,"div",1),o.TgZ(2,"div",2),o.TgZ(3,"h3",3),o._uU(4,"Restarting Server"),o.qZA(),o.YNc(5,m,2,1,"p",4),o.YNc(6,_,2,1,"p",5),o.YNc(7,f,3,1,"div",0),o.qZA(),o.qZA()),2&t&&(o.Q6J("ngIf",!e.error),o.xp6(3),o.Q6J("translate","platform.linux.restart.title_restarting_server"),o.xp6(2),o.Q6J("ngIf",!e.timeout&&!e.error),o.xp6(1),o.Q6J("ngIf",e.error),o.xp6(1),o.Q6J("ngIf",e.timeout))},directives:[r.O5,i.Pi,p.O],styles:[""]}),t})()},{path:"shutdown-server",component:(()=>{class t{constructor(t,e,s,r,i,n){this.$api=t,this.$ws=e,this.$settings=s,this.$toastr=r,this.translate=i,this.$router=n,this.io=this.$ws.connectToNamespace("status"),this.resp={},this.timeout=!1,this.error=!1}ngOnInit(){this.io.connected.subscribe(()=>{this.io.socket.emit("monitor-server-status"),this.$settings.getAppSettings().catch()}),this.$api.put("/platform-tools/linux/shutdown-host",{}).subscribe(t=>{this.resp=t,this.checkIfServerUp()},t=>{this.error=this.translate.instant("platform.linux.restart.toast_server_restart_error"),this.$toastr.error(`${this.error}: ${t.message}`,this.translate.instant("toast.title_error"))})}checkIfServerUp(){this.checkDelay=setTimeout(()=>{this.io.socket.on("homebridge-status",t=>{"up"!==t.status&&"pending"!==t.status||(this.$toastr.success(this.translate.instant("platform.linux.restart.toast_server_restarted"),this.translate.instant("toast.title_success")),this.$router.navigate(["/"]))})},3e4),this.checkTimeout=setTimeout(()=>{this.$toastr.warning(this.translate.instant("platform.linux.restart.toast_server_taking_long_time_to_come_online"),this.translate.instant("toast.title_warning"),{timeOut:1e4}),this.timeout=!0},12e4)}ngOnDestroy(){this.io.end(),clearTimeout(this.checkDelay),clearTimeout(this.checkTimeout)}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(c.s),o.Y36(l.r),o.Y36(u.g),o.Y36(h._W),o.Y36(i.sK),o.Y36(a.F0))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-shutdown-linux"]],decls:6,vars:3,consts:[[1,"row"],[1,"col-md-12","text-center"],[1,"primary-text",3,"translate"],["class","grey-text",3,"translate",4,"ngIf"],["class","grey-text",4,"ngIf"],[1,"grey-text",3,"translate"],[1,"grey-text"]],template:function(t,e){1&t&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.TgZ(2,"h3",2),o._uU(3,"Shutting Down Server "),o.qZA(),o.YNc(4,d,2,1,"p",3),o.YNc(5,x,2,1,"p",4),o.qZA(),o.qZA()),2&t&&(o.xp6(2),o.Q6J("translate","platform.linux.shutdown.title_shutting_down_server"),o.xp6(2),o.Q6J("ngIf",!e.timeout&&!e.error),o.xp6(1),o.Q6J("ngIf",e.error))},directives:[i.Pi,r.O5],styles:[""]}),t})()}];let w=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[a.Bz.forChild(v)],a.Bz]}),t})(),T=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[r.ez,i.aw.forChild(),n.I,w]]}),t})()}}]);