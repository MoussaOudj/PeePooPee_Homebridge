(self.webpackChunkui=self.webpackChunkui||[]).push([[281],{70281:function(e,o,s){"use strict";s.r(o),s.d(o,{AccessoriesModule:function(){return Q}});var t=s(38583),i=s(3679),a=s(95935),r=s(71271),n=s(88989),c=s(40294),l=s(63770),d=s(63423),g=s(37716);const u=function(){return{standalone:!0}};let m=(()=>{class e{constructor(e){this.activeModal=e}ngOnInit(){}}return e.\u0275fac=function(o){return new(o||e)(g.Y36(r.Kz))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-add-room-modal"]],inputs:{roomName:"roomName"},decls:18,vars:7,consts:[[1,"modal-content"],[1,"modal-header"],[1,"modal-title",3,"translate"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],["role","alert",1,"alert","alert-info",3,"translate"],[1,"md-form"],[1,"fas","fa-home","prefix","grey-text"],["type","text","id","form-name","autofocus","",1,"form-control","pl-0","pr-0",3,"ngModel","ngModelOptions","ngModelChange","keyup.enter"],["for","form-name",3,"translate"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"translate","click"]],template:function(e,o){1&e&&(g.TgZ(0,"div",0),g.TgZ(1,"div",1),g.TgZ(2,"h5",2),g._uU(3,"Create New Room"),g.qZA(),g.TgZ(4,"button",3),g.NdJ("click",function(){return o.activeModal.dismiss("Cross click")}),g.TgZ(5,"span",4),g._uU(6,"\xd7"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(7,"form"),g.TgZ(8,"div",5),g._UZ(9,"div",6),g.TgZ(10,"div",7),g._UZ(11,"i",8),g.TgZ(12,"input",9),g.NdJ("ngModelChange",function(e){return o.roomName=e})("keyup.enter",function(){return o.activeModal.close(o.roomName)}),g.qZA(),g.TgZ(13,"label",10),g._uU(14,"Room Name"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(15,"div",11),g.TgZ(16,"button",12),g.NdJ("click",function(){return o.activeModal.close(o.roomName)}),g._uU(17,"Create Room"),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&e&&(g.xp6(2),g.Q6J("translate","accessories.title_create_new_room"),g.xp6(7),g.Q6J("translate","accessories.message_rooms_not_appear_in_homekit"),g.xp6(3),g.Q6J("ngModel",o.roomName)("ngModelOptions",g.DdM(6,u)),g.xp6(1),g.Q6J("translate","accessories.label_room_name"),g.xp6(3),g.Q6J("translate","accessories.button_create_room"))},directives:[a.Pi,i._Y,i.JL,i.F,i.Fj,i.JJ,i.On],encapsulation:2}),e})();var p=s(49344),h=s(92503),Z=s(58605),f=s(7780),v=s(83128);let b=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-drag-here-placeholder"]],decls:3,vars:0,consts:[[1,"accessory-box"],[1,"fas","fa-arrow-alt-circle-down","accessory-icon"],["translate","accessories.control.drag_here",1,"accessory-label"]],template:function(e,o){1&e&&(g.TgZ(0,"div",0),g._UZ(1,"i",1),g._UZ(2,"div",2),g.qZA())},directives:[a.Pi],styles:[".accessory-box[_ngcontent-%COMP%]{opacity:.2}"]}),e})();const _=function(e){return{"cursor-move":e}};function x(e,o){if(1&e&&(g.TgZ(0,"div",18),g.TgZ(1,"div",19),g.TgZ(2,"h5",20),g._uU(3),g.ALo(4,"translate"),g.qZA(),g.qZA(),g.qZA()),2&e){const e=g.oxw().$implicit,o=g.oxw(2);g.xp6(2),g.Q6J("ngClass",g.VKq(4,_,!o.isMobile)),g.xp6(1),g.hij(" ","Default Room"===e.name?g.lcZ(4,2,"accessories.control.default_room"):e.name," ")}}function y(e,o){if(1&e&&(g.ynx(0),g._UZ(1,"app-accessory-tile",24),g.BQk()),2&e){const e=g.oxw().$implicit;g.xp6(1),g.Q6J("service",e)}}function A(e,o){if(1&e&&(g.TgZ(0,"div",23),g.YNc(1,y,2,1,"ng-container",0),g.qZA()),2&e){const e=o.$implicit,s=g.oxw(4);g.Q6J("ngSwitch",e.type),g.xp6(1),g.Q6J("ngIf",!s.hideHidden||!e.hidden)}}function w(e,o){if(1&e){const e=g.EpF();g.TgZ(0,"div",21),g.NdJ("dragulaModelChange",function(o){return g.CHM(e),g.oxw().$implicit.services=o}),g.YNc(1,A,2,2,"div",22),g.qZA()}if(2&e){const e=g.oxw().$implicit;g.Q6J("dragula","services-bag")("dragulaModel",e.services),g.xp6(1),g.Q6J("ngForOf",e.services)}}function M(e,o){if(1&e){const e=g.EpF();g.TgZ(0,"div",25),g.NdJ("dragulaModelChange",function(o){return g.CHM(e),g.oxw().$implicit.services=o}),g._UZ(1,"app-drag-here-placeholder",26),g.qZA()}if(2&e){const e=g.oxw().$implicit;g.Q6J("dragula","services-bag")("dragulaModel",e.services)}}function T(e,o){if(1&e&&(g.TgZ(0,"div"),g.YNc(1,x,5,6,"div",14),g.TgZ(2,"div",15),g.YNc(3,w,2,3,"div",16),g.YNc(4,M,2,2,"div",17),g.qZA(),g.qZA()),2&e){const e=o.$implicit,s=g.oxw(2);g.xp6(1),g.Q6J("ngIf",!s.isMobile||e.services.length),g.xp6(2),g.Q6J("ngIf",e.services.length),g.xp6(1),g.Q6J("ngIf",!e.services.length&&!s.isMobile)}}function q(e,o){if(1&e){const e=g.EpF();g.TgZ(0,"div"),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.TgZ(3,"h3",3),g.TgZ(4,"span",4),g._uU(5),g.ALo(6,"translate"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(7,"div",5),g.TgZ(8,"div",6),g.TgZ(9,"div",7),g.TgZ(10,"button",8),g._UZ(11,"i",9),g.qZA(),g.TgZ(12,"div",10),g.TgZ(13,"a",11),g.NdJ("click",function(){return g.CHM(e),g.oxw().addRoom()}),g._uU(14,"Add Room"),g.qZA(),g.TgZ(15,"a",11),g.NdJ("click",function(){g.CHM(e);const o=g.oxw();return o.hideHidden=!o.hideHidden}),g._uU(16,"Toggle Hidden"),g.qZA(),g.TgZ(17,"a",11),g.NdJ("click",function(){return g.CHM(e),g.oxw().toggleLayoutLock()}),g._uU(18,"Toggle Layout Lock"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(19,"div",12),g.NdJ("dragulaModelChange",function(o){return g.CHM(e),g.oxw().$accessories.rooms=o}),g.YNc(20,T,5,3,"div",13),g.qZA(),g.qZA()}if(2&e){const e=g.oxw();g.xp6(5),g.hij("Homebridge ",g.lcZ(6,7,"accessories.title_accessories"),""),g.xp6(8),g.Q6J("translate","accessories.button_add_room"),g.xp6(2),g.Q6J("translate","accessories.button_toggle_hidden"),g.xp6(2),g.Q6J("translate","accessories.button_toggle_layout_lock"),g.xp6(2),g.Q6J("dragula","rooms-bag")("dragulaModel",e.$accessories.rooms),g.xp6(1),g.Q6J("ngForOf",e.$accessories.rooms)}}function J(e,o){1&e&&(g.TgZ(0,"div"),g.TgZ(1,"div",18),g.TgZ(2,"div",27),g.TgZ(3,"h3",28),g._uU(4,"Homebridge Accessory Control Disabled"),g.qZA(),g.TgZ(5,"div"),g.TgZ(6,"p",29),g.ALo(7,"translate"),g._uU(8,"To control your accessories you must be running Homebridge in "),g.TgZ(9,"strong"),g._uU(10,"insecure"),g.qZA(),g._uU(11," mode."),g.qZA(),g.TgZ(12,"p"),g.TgZ(13,"span",30),g._uU(14,"Please see"),g.qZA(),g.TgZ(15,"a",31),g._uU(16," https://github.com/oznu/homebridge-config-ui-x/wiki/Enabling-Accessory-Control "),g.qZA(),g.TgZ(17,"span",30),g._uU(18,"for more information."),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&e&&(g.xp6(3),g.Q6J("translate","accessories.title_accessory_control_disabled"),g.xp6(3),g.Q6J("innerHTML",g.lcZ(7,4,"accessories.message_must_use_insecure_mode"),g.oJD),g.xp6(7),g.Q6J("translate","accessories.message_please_see"),g.xp6(4),g.Q6J("translate","accessories.message_for_more_information"))}const C=[{path:"",component:(()=>{class e{constructor(e,o,s,t,i,a,r){this.dragulaService=e,this.$toastr=o,this.modalService=s,this.$settings=t,this.$md=i,this.translate=a,this.$accessories=r,this.isMobile=!1,this.hideHidden=!0,this.isMobile=this.$md.detect.mobile(),e.createGroup("rooms-bag",{moves:(e,o,s)=>!this.isMobile&&s.classList.contains("drag-handle")}),e.createGroup("services-bag",{moves:(e,o,s,t)=>!this.isMobile&&!e.classList.contains("no-drag")}),this.orderSubscription=e.drop().subscribe(()=>{setTimeout(()=>{this.$accessories.saveLayout()})}),window.localStorage.getItem("accessories-layout-locked")&&(this.isMobile=!0)}ngOnInit(){this.$accessories.start()}addRoom(){this.modalService.open(m,{size:"lg"}).result.then(e=>{e&&e.length&&(this.$accessories.rooms.find(o=>o.name===e)||(this.$accessories.rooms.push({name:e,services:[]}),this.isMobile&&this.toggleLayoutLock()))}).catch(()=>{})}toggleLayoutLock(){this.isMobile=!this.isMobile,this.isMobile?(window.localStorage.setItem("accessories-layout-locked","yes"),this.$toastr.success(this.translate.instant("accessories.layout_locked"),this.translate.instant("accessories.title_accessories"))):(window.localStorage.removeItem("accessories-layout-locked"),this.$toastr.success(this.translate.instant("accessories.layout_unlocked"),this.translate.instant("accessories.title_accessories")))}ngOnDestroy(){this.$accessories.stop(),this.orderSubscription.unsubscribe(),this.dragulaService.destroy("rooms-bag"),this.dragulaService.destroy("services-bag")}}return e.\u0275fac=function(o){return new(o||e)(g.Y36(n.pQ),g.Y36(p._W),g.Y36(r.FF),g.Y36(h.g),g.Y36(Z.L),g.Y36(a.sK),g.Y36(f.N))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-accessories"]],decls:2,vars:2,consts:[[4,"ngIf"],[1,"row","mb-3"],[1,"col-sm-6"],[1,"primary-text","m-0"],[1,"d-none","d-md-inline"],[1,"col-sm-6","text-right","d-none","d-sm-block"],["role","group","aria-label","Button group with nested dropdown",1,"btn-group"],["role","group",1,"btn-group"],["id","accessory-dropdown-menu","type","button","data-toggle","dropdown",1,"btn","btn-primary","dropdown-toggle"],[1,"fas","fa-cog"],["aria-labelledby","accessory-dropdown-menu",1,"dropdown-menu","dropdown-menu-right"],["href","javascript:void(0)",1,"dropdown-item",3,"translate","click"],[3,"dragula","dragulaModel","dragulaModelChange"],[4,"ngFor","ngForOf"],["class","row",4,"ngIf"],[1,"row","mb-4"],["class","col-md-12 d-flex flex-wrap noselect services-bag",3,"dragula","dragulaModel","dragulaModelChange",4,"ngIf"],["class","col-md-12 d-flex flex-wrap noselect",3,"dragula","dragulaModel","dragulaModelChange",4,"ngIf"],[1,"row"],[1,"col-md-12"],[1,"primary-text","drag-handle","room-title",3,"ngClass"],[1,"col-md-12","d-flex","flex-wrap","noselect","services-bag",3,"dragula","dragulaModel","dragulaModelChange"],["class","accessory-item accessory-tab",3,"ngSwitch",4,"ngFor","ngForOf"],[1,"accessory-item","accessory-tab",3,"ngSwitch"],[3,"service"],[1,"col-md-12","d-flex","flex-wrap","noselect",3,"dragula","dragulaModel","dragulaModelChange"],[1,"no-drag"],[1,"col-md-12","text-center"],[1,"primary-text",3,"translate"],[3,"innerHTML"],[3,"translate"],["target","_blank","rel","noopener noreferrer","href","https://github.com/oznu/homebridge-config-ui-x/wiki/Enabling-Accessory-Control"]],template:function(e,o){1&e&&(g.YNc(0,q,21,9,"div",0),g.YNc(1,J,19,6,"div",0)),2&e&&(g.Q6J("ngIf",o.$settings.env.enableAccessories),g.xp6(1),g.Q6J("ngIf",!o.$settings.env.enableAccessories))},directives:[t.O5,a.Pi,n.sW,t.sg,t.mk,t.RF,v.Z,b],pipes:[a.X$],styles:[".room-title[_ngcontent-%COMP%]{margin-left:10px}@media (max-width: 575px){.room-title[_ngcontent-%COMP%]{margin-left:7px}}.services-bag[_ngcontent-%COMP%]{min-height:170px}@media (max-width: 575px){.services-bag[_ngcontent-%COMP%]{min-height:0;min-height:auto}}.cursor-move[_ngcontent-%COMP%]{cursor:move}.gu-transit[_ngcontent-%COMP%]   .manage-accessory-button[_ngcontent-%COMP%]{display:none}"]}),e})()}];let k=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[d.Bz.forChild(C)],d.Bz]}),e})(),Q=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[t.ez,i.u5,r.IJ,n.qE,a.aw.forChild(),c.I,l.P,k]]}),e})()}}]);