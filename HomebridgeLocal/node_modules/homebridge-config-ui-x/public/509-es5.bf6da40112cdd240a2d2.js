!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var s=0;s<e.length;s++){var r=e[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,s,r){return s&&e(t.prototype,s),r&&e(t,r),t}(self.webpackChunkui=self.webpackChunkui||[]).push([[509],{67509:function(e,r,n){"use strict";n.r(r),n.d(r,{UsersModule:function(){return K}});var a=n(38583),i=n(95935),o=n(3679),l=n(71271),u=n(40294),c=n(63423),d=n(37716),p=n(49344),f=n(79274),m=function(t){return{active:t}},Z=function(t){return{"is-invalid":t}},g=function(){var e=function(){function e(s,r,n,a){t(this,e),this.activeModal=s,this.toastr=r,this.translate=n,this.$api=a,this.page={title:"users.title_add_user",save:"users.button_add_new_user",password:"users.label_password"}}return s(e,[{key:"ngOnInit",value:function(){this.form=new o.cw({username:new o.NI("",[o.kI.required]),name:new o.NI("",[o.kI.required]),password:new o.NI("",[o.kI.compose([o.kI.required,o.kI.minLength(4)])]),passwordConfirm:new o.NI("",[o.kI.required]),admin:new o.NI(!0)},this.matchPassword)}},{key:"matchPassword",value:function(t){if(t.get("password").value===t.get("passwordConfirm").value)return null;t.get("passwordConfirm").setErrors({matchPassword:!0})}},{key:"onSubmit",value:function(t){var e=this,s=t.value;this.$api.post("/users",s).subscribe(function(t){e.activeModal.close(),e.toastr.success(e.translate.instant("users.toast_added_new_user"),e.translate.instant("toast.title_success"))},function(t){e.toastr.error(t.error.message||e.translate.instant("users.toast_failed_to_add_user"),e.translate.instant("toast.title_error"))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(d.Y36(l.Kz),d.Y36(p._W),d.Y36(i.sK),d.Y36(f.s))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-users-add"]],decls:33,vars:28,consts:[[1,"modal-content"],[1,"modal-body"],["novalidate","",3,"formGroup","ngSubmit"],[1,"h4","text-center","mb-4",3,"innerText"],[1,"md-form"],[1,"fas","fa-user-shield","prefix","grey-text"],["formControlName","username","type","text","id","form-username","autocomplete","username","autocapitalize","none",1,"form-control","pl-0","pr-0"],["for","form-username",3,"ngClass","translate"],[1,"fas","fa-user","prefix","grey-text"],["formControlName","name","type","text","id","form-name","autocomplete","name",1,"form-control","pl-0","pr-0"],["for","form-name",3,"ngClass","translate"],[1,"row","pb-3"],[1,"col-md-6"],[1,"fas","fa-lock","prefix","grey-text"],["formControlName","password","type","password","autocomplete","new-password","id","form-pass",1,"form-control","pl-0","pr-0",3,"ngClass"],["for","form-pass",3,"innerText"],["formControlName","passwordConfirm","type","password","autocomplete","new-password","id","form-pass-confirm",1,"form-control","pl-0","pr-0",3,"ngClass"],["for","form-pass-confirm",3,"translate"],[1,"form-check","text-center","mb-4"],["formControlName","admin","type","checkbox","id","isAdmin",1,"form-check-input"],["for","isAdmin",1,"form-check-label",3,"translate"],[1,"text-center"],["type","submit",1,"btn","btn-primary",3,"disabled","innerText"]],template:function(t,e){1&t&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"form",2),d.NdJ("ngSubmit",function(){return e.onSubmit(e.form)}),d._UZ(3,"p",3),d.ALo(4,"translate"),d.TgZ(5,"div",4),d._UZ(6,"i",5),d._UZ(7,"input",6),d.TgZ(8,"label",7),d._uU(9,"Username"),d.qZA(),d.qZA(),d.TgZ(10,"div",4),d._UZ(11,"i",8),d._UZ(12,"input",9),d.TgZ(13,"label",10),d._uU(14,"Full Name"),d.qZA(),d.qZA(),d.TgZ(15,"div",11),d.TgZ(16,"div",12),d.TgZ(17,"div",4),d._UZ(18,"i",13),d._UZ(19,"input",14),d._UZ(20,"label",15),d.ALo(21,"translate"),d.qZA(),d.qZA(),d.TgZ(22,"div",12),d.TgZ(23,"div",4),d._UZ(24,"input",16),d._UZ(25,"label",17),d.qZA(),d.qZA(),d.qZA(),d.TgZ(26,"div",18),d._UZ(27,"input",19),d.TgZ(28,"label",20),d._uU(29,"Admin User?"),d.qZA(),d.qZA(),d.TgZ(30,"div",21),d._UZ(31,"button",22),d.ALo(32,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&t&&(d.xp6(2),d.Q6J("formGroup",e.form),d.xp6(1),d.Q6J("innerText",d.lcZ(4,14,e.page.title)),d.xp6(4),d.uIk("disabled","users.title_edit_user"===e.page.title||null),d.xp6(1),d.Q6J("ngClass",d.VKq(20,m,"users.title_edit_user"===e.page.title))("translate","users.label_username"),d.xp6(5),d.Q6J("ngClass",d.VKq(22,m,"users.title_edit_user"===e.page.title))("translate","users.label_full_name"),d.xp6(6),d.Q6J("ngClass",d.VKq(24,Z,e.form.controls.password.dirty&&e.form.controls.password.errors)),d.xp6(1),d.Q6J("innerText",d.lcZ(21,16,e.page.password)),d.xp6(4),d.Q6J("ngClass",d.VKq(26,Z,e.form.controls.passwordConfirm.dirty&&e.form.controls.passwordConfirm.errors)),d.xp6(1),d.Q6J("translate","users.label_confirm_password"),d.xp6(3),d.Q6J("translate","users.label_admin_user"),d.xp6(3),d.Q6J("disabled",!e.form.valid)("innerText",d.lcZ(32,18,e.page.save)))},directives:[o._Y,o.JL,o.sg,o.Fj,o.JJ,o.u,a.mk,i.Pi,o.Wl],pipes:[i.X$],encapsulation:2}),e}(),_=n(88951),v=function(t){return{active:t}},b=function(t){return{"is-invalid":t}},h=function(){var e=function(){function e(s,r,n,a,i){t(this,e),this.activeModal=s,this.toastr=r,this.translate=n,this.$api=a,this.$auth=i,this.page={title:"users.title_edit_user",save:"form.button_save",password:"users.label_new_password"},this.isCurrentUser=!1}return s(e,[{key:"ngOnInit",value:function(){this.isCurrentUser=this.$auth.user.username===this.user.username,this.form=new o.cw({username:new o.NI("",[o.kI.required]),name:new o.NI("",[o.kI.required]),password:new o.NI(""),passwordConfirm:new o.NI(""),admin:new o.NI(!0)},this.matchPassword),this.form.patchValue(this.user)}},{key:"matchPassword",value:function(t){if(t.get("password").value===t.get("passwordConfirm").value)return null;t.get("passwordConfirm").setErrors({matchPassword:!0})}},{key:"onSubmit",value:function(t){var e=this,s=t.value;this.$api.patch("/users/".concat(this.user.id),s).subscribe(function(t){e.activeModal.close(),e.toastr.success(e.translate.instant("users.toast_updated_user"),e.translate.instant("toast.title_success")),e.isCurrentUser&&s.username!==e.$auth.user.username&&e.$auth.logout()},function(t){e.toastr.error(t.error.message||e.translate.instant("users.toast_failed_to_add_user"),e.translate.instant("toast.title_error"))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(d.Y36(l.Kz),d.Y36(p._W),d.Y36(i.sK),d.Y36(f.s),d.Y36(_.e))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-users-edit"]],inputs:{user:"user"},decls:33,vars:27,consts:[[1,"modal-content"],[1,"modal-body"],["novalidate","",3,"formGroup","ngSubmit"],[1,"h4","text-center","mb-4",3,"innerText"],[1,"md-form"],[1,"fas","fa-user-shield","prefix","grey-text"],["formControlName","username","type","text","id","form-username","autocomplete","off","autocapitalize","none",1,"form-control","pl-0","pr-0"],["for","form-username",3,"ngClass","translate"],[1,"fas","fa-user","prefix","grey-text"],["formControlName","name","type","text","id","form-name","autocomplete","name",1,"form-control","pl-0","pr-0"],["for","form-name",3,"ngClass","translate"],[1,"row","pb-3"],[1,"col-md-6"],[1,"fas","fa-lock","prefix","grey-text"],["formControlName","password","type","password","autocomplete","new-password","id","form-pass",1,"form-control","pl-0","pr-0",3,"ngClass"],["for","form-pass",3,"innerText"],["formControlName","passwordConfirm","type","password","autocomplete","new-password","id","form-pass-confirm",1,"form-control","pl-0","pr-0",3,"ngClass"],["for","form-pass-confirm",3,"translate"],[1,"form-check","text-center","mb-4"],["formControlName","admin","type","checkbox","id","isAdmin",1,"form-check-input"],["for","isAdmin",1,"form-check-label",3,"translate"],[1,"text-center"],["type","submit",1,"btn","btn-primary",3,"disabled","innerText"]],template:function(t,e){1&t&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"form",2),d.NdJ("ngSubmit",function(){return e.onSubmit(e.form)}),d._UZ(3,"p",3),d.ALo(4,"translate"),d.TgZ(5,"div",4),d._UZ(6,"i",5),d._UZ(7,"input",6),d.TgZ(8,"label",7),d._uU(9,"Username"),d.qZA(),d.qZA(),d.TgZ(10,"div",4),d._UZ(11,"i",8),d._UZ(12,"input",9),d.TgZ(13,"label",10),d._uU(14,"Full Name"),d.qZA(),d.qZA(),d.TgZ(15,"div",11),d.TgZ(16,"div",12),d.TgZ(17,"div",4),d._UZ(18,"i",13),d._UZ(19,"input",14),d._UZ(20,"label",15),d.ALo(21,"translate"),d.qZA(),d.qZA(),d.TgZ(22,"div",12),d.TgZ(23,"div",4),d._UZ(24,"input",16),d._UZ(25,"label",17),d.qZA(),d.qZA(),d.qZA(),d.TgZ(26,"div",18),d._UZ(27,"input",19),d.TgZ(28,"label",20),d._uU(29,"Admin User?"),d.qZA(),d.qZA(),d.TgZ(30,"div",21),d._UZ(31,"button",22),d.ALo(32,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&t&&(d.xp6(2),d.Q6J("formGroup",e.form),d.xp6(1),d.Q6J("innerText",d.lcZ(4,13,e.page.title)),d.xp6(5),d.Q6J("ngClass",d.VKq(19,v,"users.title_edit_user"===e.page.title))("translate","users.label_username"),d.xp6(5),d.Q6J("ngClass",d.VKq(21,v,"users.title_edit_user"===e.page.title))("translate","users.label_full_name"),d.xp6(6),d.Q6J("ngClass",d.VKq(23,b,e.form.controls.password.dirty&&e.form.controls.password.errors)),d.xp6(1),d.Q6J("innerText",d.lcZ(21,15,e.page.password)),d.xp6(4),d.Q6J("ngClass",d.VKq(25,b,e.form.controls.passwordConfirm.dirty&&e.form.controls.passwordConfirm.errors)),d.xp6(1),d.Q6J("translate","users.label_confirm_password"),d.xp6(3),d.Q6J("translate","users.label_admin_user"),d.xp6(3),d.Q6J("disabled",!e.form.valid)("innerText",d.lcZ(32,17,e.page.save)))},directives:[o._Y,o.JL,o.sg,o.Fj,o.JJ,o.u,a.mk,i.Pi,o.Wl],pipes:[i.X$],encapsulation:2}),e}(),w=n(48873),x=n(87575),A=["qrcode"],q=function(t){return{timeDiffError:t}};function T(t,e){if(1&t&&(d.TgZ(0,"div",15),d.TgZ(1,"h3"),d._uU(2),d.ALo(3,"translate"),d.qZA(),d._UZ(4,"p",16),d.qZA()),2&t){var s=d.oxw();d.xp6(2),d.Oqu(d.lcZ(3,3,"users.setup_2fa_cannot_setup_2fa")),d.xp6(2),d.Q6J("translate","users.setup_2fa_server_time_out")("translateParams",d.VKq(5,q,s.timeDiffError))}}function U(t,e){1&t&&(d.TgZ(0,"div"),d.TgZ(1,"p"),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.qZA()),2&t&&(d.xp6(2),d.Oqu(d.lcZ(3,1,"users.setup_2fa_scan_qr_code")))}function y(t,e){if(1&t&&(d.TgZ(0,"div",17),d.TgZ(1,"p"),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"div",18),d._UZ(5,"input",19),d.qZA(),d.qZA()),2&t){var s=d.oxw();d.xp6(2),d.Oqu(d.lcZ(3,2,"users.setup_2fa_enter_code")),d.xp6(3),d.Q6J("formControl",s.formGroup.controls.code)}}function k(t,e){if(1&t){var s=d.EpF();d.TgZ(0,"button",20),d.NdJ("click",function(){return d.CHM(s),d.oxw().enable2fa()}),d._uU(1,"Enable 2FA"),d.qZA()}if(2&t){var r=d.oxw();d.Q6J("disabled",r.formGroup.invalid)("translate","users.setup_2fa_enable")}}var J=function(){var e=function(){function e(s,r,n,a){t(this,e),this.activeModal=s,this.toastr=r,this.translate=n,this.$api=a,this.timeDiffError=null}return s(e,[{key:"ngOnInit",value:function(){var t=this;this.formGroup=new o.cw({code:new o.NI("",[o.kI.required,o.kI.minLength(6),o.kI.maxLength(6)])}),this.$api.post("/users/otp/setup",{}).subscribe(function(e){t.checkTimeDiff(e.timestamp),t.timeDiffError||(t.otpString=e.otpauth)},function(e){t.activeModal.dismiss(),t.toastr.error(e.error.message||"An error occured while attempting to setup 2FA",t.translate.instant("toast.title_error"))})}},{key:"checkTimeDiff",value:function(t){var e=w(t).diff(new Date,"millisecond");this.timeDiffError=e<-5e3||e>5e3?e:null}},{key:"enable2fa",value:function(){var t=this;this.$api.post("/users/otp/activate",this.formGroup.value).subscribe(function(e){t.toastr.success(t.translate.instant("users.setup_2fa_enabled_success"),t.translate.instant("toast.title_success")),t.activeModal.close()},function(e){t.toastr.error(e.error.message||"An error occured",t.translate.instant("toast.title_error"))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(d.Y36(l.Kz),d.Y36(p._W),d.Y36(i.sK),d.Y36(f.s))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-users-setup2fa"]],viewQuery:function(t,e){var s;(1&t&&d.Gf(A,7),2&t)&&(d.iGM(s=d.CRH())&&(e.qrcodeElement=s.first))},inputs:{user:"user"},decls:21,vars:13,consts:[[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],["class","text-center",4,"ngIf"],["type","info",3,"dismissible"],[4,"ngIf"],[1,"text-center","w-100","d-flex","justify-content-center"],[3,"data"],["class","mt-4",4,"ngIf"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-elegant",3,"translate","click"],["type","button","class","btn btn-primary","data-dismiss","modal",3,"disabled","translate","click",4,"ngIf"],[1,"text-center"],[3,"translate","translateParams"],[1,"mt-4"],[1,"form-group"],["type","text","placeholder","eg. 123456","autocomplete","one-time-code","autocapitalize","none","inputmode","numeric","pattern","[0-9]*",1,"form-control",3,"formControl"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"disabled","translate","click"]],template:function(t,e){1&t&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"h5",2),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.TgZ(5,"button",3),d.NdJ("click",function(){return e.activeModal.dismiss("Cross click")}),d.TgZ(6,"span",4),d._uU(7,"\xd7"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(8,"div",5),d.YNc(9,T,5,7,"div",6),d.TgZ(10,"ngb-alert",7),d._uU(11),d.ALo(12,"translate"),d.qZA(),d.YNc(13,U,4,3,"div",8),d.TgZ(14,"div",9),d._UZ(15,"app-qrcode",10),d.qZA(),d.YNc(16,y,6,4,"div",11),d.qZA(),d.TgZ(17,"div",12),d.TgZ(18,"button",13),d.NdJ("click",function(){return e.activeModal.dismiss("Cross click")}),d._uU(19,"Cancel"),d.qZA(),d.YNc(20,k,2,2,"button",14),d.qZA(),d.qZA()),2&t&&(d.xp6(3),d.Oqu(d.lcZ(4,9,"users.setup_2fa")),d.xp6(6),d.Q6J("ngIf",e.timeDiffError),d.xp6(1),d.Q6J("dismissible",!1),d.xp6(1),d.hij(" ",d.lcZ(12,11,"users.setup_2fa_warning")," "),d.xp6(2),d.Q6J("ngIf",!e.timeDiffError),d.xp6(2),d.Q6J("data",e.otpString),d.xp6(1),d.Q6J("ngIf",!e.timeDiffError),d.xp6(2),d.Q6J("translate","form.button_cancel"),d.xp6(2),d.Q6J("ngIf",!e.timeDiffError))},directives:[a.O5,l.xm,x.z,i.Pi,o.Fj,o.c5,o.JJ,o.oH],pipes:[i.X$],styles:[""]}),e}();function C(t,e){1&t&&(d.TgZ(0,"p",12),d.TgZ(1,"small",13),d._uU(2,"Invalid Username and Password"),d.qZA(),d.qZA()),2&t&&(d.xp6(1),d.Q6J("translate","login.message_invalid_username_or_password"))}var I=function(){var e=function(){function e(s,r,n,a){t(this,e),this.activeModal=s,this.toastr=r,this.translate=n,this.$api=a,this.invalidCredentials=!1}return s(e,[{key:"ngOnInit",value:function(){this.formGroup=new o.cw({password:new o.NI("",[o.kI.required])})}},{key:"disable2fa",value:function(){var t=this;this.invalidCredentials=!1,this.$api.post("/users/otp/deactivate",this.formGroup.value).subscribe(function(e){t.activeModal.close(),t.toastr.success(t.translate.instant("users.setup_2fa_disable_success"),t.translate.instant("toast.title_success"))},function(e){t.formGroup.setValue({password:""}),t.invalidCredentials=!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(d.Y36(l.Kz),d.Y36(p._W),d.Y36(i.sK),d.Y36(f.s))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-users-disable2fa"]],decls:23,vars:18,consts:[[1,"modal-content",2,"min-height","300px"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group"],["type","password","autocomplete","current-password",1,"form-control",3,"formControl","placeholder"],["class","red-text",4,"ngIf"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-elegant","mr-auto",3,"click"],["type","button","data-dismiss","modal",1,"btn","btn-danger",3,"disabled","click"],[1,"red-text"],[3,"translate"]],template:function(t,e){1&t&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"h5",2),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.TgZ(5,"button",3),d.NdJ("click",function(){return e.activeModal.dismiss("Dismiss")}),d.TgZ(6,"span",4),d._uU(7,"\xd7"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(8,"div",5),d.TgZ(9,"p"),d._uU(10),d.ALo(11,"translate"),d.qZA(),d.TgZ(12,"div",6),d._UZ(13,"input",7),d.ALo(14,"translate"),d.qZA(),d.YNc(15,C,3,1,"p",8),d.qZA(),d.TgZ(16,"div",9),d.TgZ(17,"button",10),d.NdJ("click",function(){return e.activeModal.dismiss("Dismiss")}),d._uU(18),d.ALo(19,"translate"),d.qZA(),d.TgZ(20,"button",11),d.NdJ("click",function(){return e.disable2fa()}),d._uU(21),d.ALo(22,"translate"),d.qZA(),d.qZA(),d.qZA()),2&t&&(d.xp6(3),d.Oqu(d.lcZ(4,8,"users.setup_2fa_disable")),d.xp6(7),d.Oqu(d.lcZ(11,10,"users.setup_2fa_disable_enter_current_password")),d.xp6(3),d.Q6J("formControl",e.formGroup.controls.password)("placeholder",d.lcZ(14,12,"users.label_password")),d.xp6(2),d.Q6J("ngIf",e.invalidCredentials),d.xp6(3),d.hij(" ",d.lcZ(19,14,"form.button_cancel")," "),d.xp6(2),d.Q6J("disabled",e.formGroup.invalid),d.xp6(1),d.hij(" ",d.lcZ(22,16,"users.setup_2fa_disable")," "))},directives:[o.Fj,o.JJ,o.oH,a.O5,i.Pi],pipes:[i.X$],styles:[""]}),e}();function N(t,e){if(1&t){var s=d.EpF();d.TgZ(0,"button",15),d.NdJ("click",function(){d.CHM(s);var t=d.oxw().$implicit;return d.oxw().deleteUser(t.id)}),d._uU(1," Delete "),d.qZA()}2&t&&d.Q6J("translate","form.button_delete")}function Q(t,e){if(1&t){var s=d.EpF();d.TgZ(0,"button",14),d.NdJ("click",function(){d.CHM(s);var t=d.oxw().$implicit;return d.oxw().setup2fa(t)}),d._uU(1," Setup 2FA "),d.qZA()}2&t&&d.Q6J("translate","users.setup_2fa")}function $(t,e){if(1&t){var s=d.EpF();d.TgZ(0,"button",14),d.NdJ("click",function(){d.CHM(s);var t=d.oxw().$implicit;return d.oxw().disable2fa(t)}),d._uU(1," Disable 2FA "),d.qZA()}2&t&&d.Q6J("translate","users.setup_2fa_disable")}function Y(t,e){if(1&t){var s=d.EpF();d.TgZ(0,"div",8),d.TgZ(1,"div",9),d.TgZ(2,"div",10),d._UZ(3,"h4",11),d.YNc(4,N,2,1,"button",12),d.YNc(5,Q,2,1,"button",13),d.YNc(6,$,2,1,"button",13),d.TgZ(7,"button",14),d.NdJ("click",function(){var t=d.CHM(s).$implicit;return d.oxw().openEditUser(t)}),d._uU(8," Edit "),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&t){var r=e.$implicit,n=d.oxw();d.xp6(3),d.Q6J("innerText",r.name),d.xp6(1),d.Q6J("ngIf",n.$auth.user.username!==r.username),d.xp6(1),d.Q6J("ngIf",n.$auth.user.username===r.username&&!r.otpActive),d.xp6(1),d.Q6J("ngIf",n.$auth.user.username===r.username&&r.otpActive),d.xp6(1),d.Q6J("translate","form.button_edit")}}var L,F=function(){var e=function(){function e(s,r,n,a,i,o){t(this,e),this.toastr=s,this.translate=r,this.modalService=n,this.$api=a,this.$route=i,this.$auth=o}return s(e,[{key:"ngOnInit",value:function(){var t=this;this.$route.data.subscribe(function(e){t.homebridgeUsers=e.homebridgeUsers})}},{key:"reloadUsers",value:function(){var t=this;return this.$api.get("/users").subscribe(function(e){t.homebridgeUsers=e})}},{key:"openAddNewUser",value:function(){var t=this;this.modalService.open(g,{size:"lg"}).result.finally(function(){t.reloadUsers()})}},{key:"openEditUser",value:function(t){var e=this,s=this.modalService.open(h,{size:"lg"});s.componentInstance.user=t,s.result.finally(function(){e.reloadUsers()})}},{key:"deleteUser",value:function(t){var e=this;this.$api.delete("/users/".concat(t)).subscribe(function(t){e.toastr.success(e.translate.instant("users.toast_user_deleted"),e.translate.instant("toast.title_success")),e.reloadUsers()},function(t){e.toastr.error(t.error.message||e.translate.instant("users.toast_failed_to_delete_user"),e.translate.instant("toast.title_error"))})}},{key:"setup2fa",value:function(t){var e=this,s=this.modalService.open(J,{size:"lg",backdrop:"static"});s.componentInstance.user=t,s.result.finally(function(){e.reloadUsers()})}},{key:"disable2fa",value:function(t){var e=this,s=this.modalService.open(I,{backdrop:"static"});s.componentInstance.user=t,s.result.finally(function(){e.reloadUsers()})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(d.Y36(p._W),d.Y36(i.sK),d.Y36(l.FF),d.Y36(f.s),d.Y36(c.gz),d.Y36(_.e))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-users"]],decls:12,vars:5,consts:[[1,"row","mb-3"],[1,"col-sm-9","d-none","d-sm-block"],[1,"primary-text","m-0"],[1,"d-none","d-md-inline"],[1,"col-sm-3","text-right"],[1,"btn","btn-primary","waves-effect","m-0",3,"translate","click"],[1,"row"],["class","col-md-6 mb-4",4,"ngFor","ngForOf"],[1,"col-md-6","mb-4"],[1,"card","card-body"],[1,"d-flex","flex-row","align-items-center"],[1,"mr-auto","mt-0","mb-0",3,"innerText"],["class","btn btn-elegant btn-sml mt-0 mb-0",3,"translate","click",4,"ngIf"],["class","btn btn-primary mt-0 mb-0",3,"translate","click",4,"ngIf"],[1,"btn","btn-primary","mt-0","mb-0",3,"translate","click"],[1,"btn","btn-elegant","btn-sml","mt-0","mb-0",3,"translate","click"]],template:function(t,e){1&t&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"h3",2),d.TgZ(3,"span",3),d._uU(4,"Homebridge Config UI"),d.qZA(),d._uU(5),d.ALo(6,"translate"),d.qZA(),d.qZA(),d.TgZ(7,"div",4),d.TgZ(8,"button",5),d.NdJ("click",function(){return e.openAddNewUser()}),d._uU(9,"Add User"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(10,"div",6),d.YNc(11,Y,9,5,"div",7),d.qZA()),2&t&&(d.xp6(5),d.hij(" ",d.lcZ(6,3,"users.title_users"),""),d.xp6(3),d.Q6J("translate","users.button_add_user"),d.xp6(3),d.Q6J("ngForOf",e.homebridgeUsers))},directives:[i.Pi,a.sg,a.O5],pipes:[i.X$],encapsulation:2}),e}(),E=function(){var e=function(){function e(s,r,n){t(this,e),this.$api=s,this.$toastr=r,this.$router=n}return s(e,[{key:"resolve",value:function(t,e){var s=this;return this.$api.get("/users").toPromise().catch(function(t){s.$toastr.error(t.message,"Failed to Load Users"),s.$router.navigate(["/"])})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(d.LFG(f.s),d.LFG(p._W),d.LFG(c.F0))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac}),e}(),M=[{path:"",component:F,resolve:{homebridgeUsers:E}}],G=function(){var e=function e(){t(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[c.Bz.forChild(M)],c.Bz]}),e}(),K=((L=function e(){t(this,e)}).\u0275fac=function(t){return new(t||L)},L.\u0275mod=d.oAB({type:L}),L.\u0275inj=d.cJS({providers:[E],imports:[[a.ez,o.u5,o.UX,i.aw.forChild(),l.IJ,u.I,G]]}),L)}}])}();