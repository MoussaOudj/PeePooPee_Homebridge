!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}(self.webpackChunkui=self.webpackChunkui||[]).push([[225],{94225:function(e,n,s){"use strict";s.r(n),s.d(n,{LinuxModule:function(){return b}});var i=s(38583),a=s(95935),o=s(40294),c=s(63423),u=s(37716),l=s(79274),p=s(45417),h=s(92503),f=s(49344),g=s(48703);function m(t,e){1&t&&u._UZ(0,"app-spinner")}function _(t,e){1&t&&(u.TgZ(0,"p",6),u._uU(1,"Please wait, this page will automatically redirect when the Homebridge is back online."),u.qZA()),2&t&&u.Q6J("translate","platform.linux.restart.message_please_wait_while_server_restarts")}function v(t,e){if(1&t&&(u.TgZ(0,"p",7),u._uU(1),u.qZA()),2&t){var r=u.oxw();u.xp6(1),u.Oqu(r.error)}}function d(t,e){1&t&&(u.TgZ(0,"div"),u.TgZ(1,"p",6),u._uU(2,"Server restart is taking a long time. You may need to bring up the server back up manually."),u.qZA(),u.qZA()),2&t&&(u.xp6(1),u.Q6J("translate","platform.linux.restart.message_server_taking_long_time_to_restart"))}function w(t,e){1&t&&(u.TgZ(0,"p",5),u._uU(1,"The server will power down shortly."),u.qZA()),2&t&&u.Q6J("translate","platform.linux.shutdown.message_server_will_power_down")}function x(t,e){if(1&t&&(u.TgZ(0,"p",6),u._uU(1),u.qZA()),2&t){var r=u.oxw();u.xp6(1),u.Oqu(r.error)}}var y,k,T,Z=[{path:"",redirectTo:"/",pathMatch:"full"},{path:"restart-server",component:(k=function(){function e(r,n,s,i,a,o){t(this,e),this.$api=r,this.$ws=n,this.$settings=s,this.$toastr=i,this.translate=a,this.$router=o,this.io=this.$ws.connectToNamespace("status"),this.resp={},this.timeout=!1,this.error=!1}return r(e,[{key:"ngOnInit",value:function(){var t=this;this.io.connected.subscribe(function(){t.io.socket.emit("monitor-server-status"),t.$settings.getAppSettings().catch()}),this.$api.put("/platform-tools/linux/restart-host",{}).subscribe(function(e){t.resp=e,t.checkIfServerUp()},function(e){t.error=t.translate.instant("platform.linux.restart.toast_server_restart_error"),t.$toastr.error("".concat(t.error,": ").concat(e.message),t.translate.instant("toast.title_error"))})}},{key:"checkIfServerUp",value:function(){var t=this;this.checkDelay=setTimeout(function(){t.io.socket.on("homebridge-status",function(e){"up"!==e.status&&"pending"!==e.status||(t.$toastr.success(t.translate.instant("platform.linux.restart.toast_server_restarted"),t.translate.instant("toast.title_success")),t.$router.navigate(["/"]))})},3e4),this.checkTimeout=setTimeout(function(){t.$toastr.warning(t.translate.instant("platform.linux.restart.toast_server_taking_long_time_to_come_online"),t.translate.instant("toast.title_warning"),{timeOut:1e4}),t.timeout=!0},12e4)}},{key:"ngOnDestroy",value:function(){this.io.end(),clearTimeout(this.checkDelay),clearTimeout(this.checkTimeout)}}]),e}(),k.\u0275fac=function(t){return new(t||k)(u.Y36(l.s),u.Y36(p.r),u.Y36(h.g),u.Y36(f._W),u.Y36(a.sK),u.Y36(c.F0))},k.\u0275cmp=u.Xpm({type:k,selectors:[["app-restart-linux"]],decls:8,vars:5,consts:[[4,"ngIf"],[1,"row"],[1,"col-md-12","text-center"],[1,"primary-text",3,"translate"],["class","grey-text",3,"translate",4,"ngIf"],["class","grey-text",4,"ngIf"],[1,"grey-text",3,"translate"],[1,"grey-text"]],template:function(t,e){1&t&&(u.YNc(0,m,1,0,"app-spinner",0),u.TgZ(1,"div",1),u.TgZ(2,"div",2),u.TgZ(3,"h3",3),u._uU(4,"Restarting Server"),u.qZA(),u.YNc(5,_,2,1,"p",4),u.YNc(6,v,2,1,"p",5),u.YNc(7,d,3,1,"div",0),u.qZA(),u.qZA()),2&t&&(u.Q6J("ngIf",!e.error),u.xp6(3),u.Q6J("translate","platform.linux.restart.title_restarting_server"),u.xp6(2),u.Q6J("ngIf",!e.timeout&&!e.error),u.xp6(1),u.Q6J("ngIf",e.error),u.xp6(1),u.Q6J("ngIf",e.timeout))},directives:[i.O5,a.Pi,g.O],styles:[""]}),k)},{path:"shutdown-server",component:(y=function(){function e(r,n,s,i,a,o){t(this,e),this.$api=r,this.$ws=n,this.$settings=s,this.$toastr=i,this.translate=a,this.$router=o,this.io=this.$ws.connectToNamespace("status"),this.resp={},this.timeout=!1,this.error=!1}return r(e,[{key:"ngOnInit",value:function(){var t=this;this.io.connected.subscribe(function(){t.io.socket.emit("monitor-server-status"),t.$settings.getAppSettings().catch()}),this.$api.put("/platform-tools/linux/shutdown-host",{}).subscribe(function(e){t.resp=e,t.checkIfServerUp()},function(e){t.error=t.translate.instant("platform.linux.restart.toast_server_restart_error"),t.$toastr.error("".concat(t.error,": ").concat(e.message),t.translate.instant("toast.title_error"))})}},{key:"checkIfServerUp",value:function(){var t=this;this.checkDelay=setTimeout(function(){t.io.socket.on("homebridge-status",function(e){"up"!==e.status&&"pending"!==e.status||(t.$toastr.success(t.translate.instant("platform.linux.restart.toast_server_restarted"),t.translate.instant("toast.title_success")),t.$router.navigate(["/"]))})},3e4),this.checkTimeout=setTimeout(function(){t.$toastr.warning(t.translate.instant("platform.linux.restart.toast_server_taking_long_time_to_come_online"),t.translate.instant("toast.title_warning"),{timeOut:1e4}),t.timeout=!0},12e4)}},{key:"ngOnDestroy",value:function(){this.io.end(),clearTimeout(this.checkDelay),clearTimeout(this.checkTimeout)}}]),e}(),y.\u0275fac=function(t){return new(t||y)(u.Y36(l.s),u.Y36(p.r),u.Y36(h.g),u.Y36(f._W),u.Y36(a.sK),u.Y36(c.F0))},y.\u0275cmp=u.Xpm({type:y,selectors:[["app-shutdown-linux"]],decls:6,vars:3,consts:[[1,"row"],[1,"col-md-12","text-center"],[1,"primary-text",3,"translate"],["class","grey-text",3,"translate",4,"ngIf"],["class","grey-text",4,"ngIf"],[1,"grey-text",3,"translate"],[1,"grey-text"]],template:function(t,e){1&t&&(u.TgZ(0,"div",0),u.TgZ(1,"div",1),u.TgZ(2,"h3",2),u._uU(3,"Shutting Down Server "),u.qZA(),u.YNc(4,w,2,1,"p",3),u.YNc(5,x,2,1,"p",4),u.qZA(),u.qZA()),2&t&&(u.xp6(2),u.Q6J("translate","platform.linux.shutdown.title_shutting_down_server"),u.xp6(2),u.Q6J("ngIf",!e.timeout&&!e.error),u.xp6(1),u.Q6J("ngIf",e.error))},directives:[a.Pi,i.O5],styles:[""]}),y)}],$=function(){var e=function e(){t(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[c.Bz.forChild(Z)],c.Bz]}),e}(),b=((T=function e(){t(this,e)}).\u0275fac=function(t){return new(t||T)},T.\u0275mod=u.oAB({type:T}),T.\u0275inj=u.cJS({imports:[[i.ez,a.aw.forChild(),o.I,$]]}),T)}}])}();